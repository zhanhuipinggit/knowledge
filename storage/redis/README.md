# Redis 课程大纲：核心功能与源码实现

## [1. Redis 概述与架构设计](./1.redis概述与架构设计.md)
### 1.1 **Redis 简介**
- **Redis** 是一个开源的高性能键值存储数据库，支持持久化、丰富的数据结构（如字符串、哈希、列表、集合、有序集合等），广泛用于缓存、消息队列等场景。
- 介绍 Redis 的 **单线程模型**、**事件驱动机制** 和 **内存存储** 特性。

### 1.2 **Redis 核心架构**
- **客户端与服务器**：客户端通过 **TCP 协议** 与 Redis 服务器通信，Redis 采用 **单线程** 事件循环模型处理请求。
- **事件驱动与 I/O 多路复用**：介绍 Redis 如何使用 **I/O 多路复用**（如 epoll）来高效处理客户端请求，基于 **libevent** 库实现。
- **主从复制与持久化机制**：Redis 提供 **主从复制**、**AOF**（Append Only File）与 **RDB**（Redis Database）持久化机制，保证数据的可靠性。

### 1.3 **Redis 数据结构与核心命令**
- **数据结构**：深入介绍 Redis 支持的基本数据结构（如 **String**、**List**、**Set**、**Hash**、**Sorted Set** 等）及其在 Redis 中的实现。
- **核心命令**：简要讲解 Redis 的常用命令，如何通过命令与数据交互，如 `SET`、`GET`、`HSET`、`LPUSH`、`ZADD` 等。

---

## [2. Redis 核心实现原理与源码分析](./2.Redis核心实现原理与源码分析.md)
### 2.1 **Redis 内存管理与数据存储**
- **内存分配**：Redis 使用自定义内存分配器（`jemalloc` 或 `libc`）来管理内存，分析其内存分配机制、内存碎片管理以及如何处理大数据量存储。
- **数据存储**：Redis 是一个内存数据库，所有数据都存储在内存中，如何通过 **字典（hash table）** 实现键值对的高效存储和检索。
- **压缩和优化**：介绍 Redis 如何通过 **Ziplist** 和 **Skiplist** 等技术优化内存使用，减少内存占用。

### 2.2 **Redis 命令执行流程与数据模型**
- **命令执行流程**：从客户端请求到 Redis 处理的过程，如何通过 **Redis 命令解析**、**执行器** 和 **数据结构** 进行处理。
    - **命令解析**：如何解析客户端发送的命令，使用 `redisCommand` 函数将命令转化为对应的操作。
    - **命令执行**：Redis 如何执行简单的字符串存取、列表操作等常见命令。

- **数据结构模型**：深入分析 Redis 中的核心数据结构，如：
    - **字符串（String）**：如何使用简单的字典实现字符串存储。
    - **哈希表（Hash）**：如何处理字段与值的映射，优化内存。
    - **链表（List）**：如何利用双向链表实现队列和栈的功能。
    - **集合（Set）和有序集合（Sorted Set）**：如何通过 **哈希表** 和 **跳表** 实现集合操作，分析插入、查找、删除的时间复杂度。

### 2.3 **Redis 事件驱动与多路复用机制**
- **事件循环机制**：Redis 的核心是 **事件驱动模型**，每个客户端请求都通过 **I/O 多路复用机制**（如 epoll）进行处理。
    - 事件循环：如何通过 `aeCreateEventLoop` 创建事件循环，并通过 `aeMain` 处理客户端的请求。
    - **I/O 多路复用**：分析 Redis 如何通过 epoll、select 或 kqueue 等机制管理多个连接。

### 2.4 **Redis 持久化与数据安全**
- **RDB 快照**：介绍 RDB 文件的生成过程，如何将内存中的数据持久化到磁盘。
    - 如何通过配置文件设置持久化策略，分析 RDB 文件的保存策略、生成过程和恢复机制。
- **AOF 日志**：分析 AOF（Append Only File）持久化的工作原理，如何记录每次写命令，并在 Redis 重启时恢复数据。
    - AOF 日志的同步策略：介绍 `always`、`everysec` 和 `no` 的策略差异。
- **AOF 重写**：分析如何通过 AOF 重写来优化存储空间，防止 AOF 文件过度膨胀。

### 2.5 **Redis 主从复制与高可用性**
- **主从复制**：分析 Redis 如何实现主从复制，如何通过 **复制协议** 将数据从主节点同步到从节点。
- **复制过程**：主节点如何通过 `SYNC` 命令向从节点发送数据，如何利用复制机制保证高可用性和数据一致性。
- **哨兵（Sentinel）与高可用性**：介绍 Redis 哨兵（Sentinel）机制，如何通过监控、故障转移等手段保证 Redis 集群的高可用性。

### 2.6 **Redis 性能优化与调优**
- **性能优化**：如何通过合理的内存管理、优化命令执行、减少 I/O 操作来提升 Redis 的性能。
- **持久化优化**：如何平衡数据持久化的性能与可靠性，避免频繁的 RDB 快照和 AOF 写入带来的性能开销。
- **网络与内存调优**：分析 Redis 在网络 I/O 和内存使用上的优化策略，包括通过 `maxmemory` 配置来限制内存使用，并采取 LRU 或 LFU 策略淘汰数据。

---

## 总结与扩展
- **Redis 内部机制复习**：回顾 Redis 的核心架构、内存管理、命令执行、持久化和主从复制等方面。
- **源码分析与性能调优**：结合源码分析，学习如何优化 Redis 性能，定制 Redis 以适应不同场景需求。
- **扩展学习**：为学生推荐进一步学习的方向，如 Redis Cluster 分布式架构、消息队列实现、分布式缓存等。

